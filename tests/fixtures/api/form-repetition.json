[

{
  "_name": "Repeat (valid)",

  "fixtures": {
    "forms": [{
      "meta": {
        "id": "form"
      },
      "fields": [{
        "id": "field",
        "repeat": true,
        "type": "integer"
      }]
    }],

    "input": [
      { "$form": "form", "field": [ 1, 2, 3, 4 ] },
      { "$form": "form", "field": false },
      { "$form": "form", "field": [ ] },
      { "$form": "form", "field": [ 1, "Hello", 2, [ ], { } ] }
    ]
  },

  "expect": {
    "load": {
      "valid": true,
      "result": [{
        "fields": [{
          "repeat": [ 0, 1e9999 ]
        }]
      }]
    },

    "fill": [{
      "valid": true,
      "detail": {
        "field": {
          "valid": true,
          "detail": [
            { "valid": true }, { "valid": true },
            { "valid": true }, { "valid": true }
          ]
        }
      }
    }, {
      "valid": true,
      "field": { "valid": true, "omitted": true }
    }, {
      "valid": true,
      "detail": {
        "field": { "valid": true, "detail": [ ] }
      }
    }, {
      "valid": false,
      "detail": {
        "field": {
          "valid": false,
          "detail": [
            { "valid": true },
            { "valid": false, "error": "Value must be an integer" },
            { "valid": true },
            { "valid": false, "error": "Value must be an integer" },
            { "valid": false, "error": "Value must be an integer" }
          ]
        }
      }
    }]
  }
},

{
  "_name": "Repeat (required, valid)",

  "fixtures": {
    "forms": [{
      "meta": {
        "id": "form"
      },
      "fields": [{
        "id": "field",
        "repeat": true,
        "required": true,
        "type": "integer"
      }]
    }],

    "input": [
      { "$form": "form", "field": [ ] },
      { "$form": "form", "field": false },
      { "$form": "form", "extra": "property" }
    ]
  },

  "expect": {
    "load": {
      "valid": true,
      "result": [{
        "fields": [{
          "repeat": [ 1, 1e9999 ]
        }]
      }]
    },

    "fill": [{
      "valid": false,
      "detail": {
        "field": {
          "valid": false
        }
      }
    }, {
      "valid": false,
      "detail": {
        "field": {
          "valid": false,
          "error": "Value for repeating field must be an array"
        }
      }
    }, {
      "valid": false,
      "detail": {
        "field": {
          "valid": false,
          "error": "Value for repeating field must be an array"
        }
      }
    }]
  }
},

{
  "_name": "Repeat (string, invalid)",

  "fixtures": {
    "forms": [{
      "meta": {
        "id": "form"
      },
      "fields": [{
        "id": "field",
        "type": "integer",
        "repeat": "Testing"
      }]
    }],

    "input": [
    ]
  },

  "expect": {
    "load": {
      "valid": false,
      "phase": "schema"
    },

    "fill": [
    ]
  }
},

{
  "_name": "Repeat (negative, invalid)",

  "fixtures": {
    "forms": [{
      "meta": {
        "id": "form"
      },
      "fields": [{
        "id": "field",
        "type": "integer",
        "repeat": -1
      }]
    }],

    "input": [
    ]
  },

  "expect": {
    "load": {
      "valid": false,
      "phase": "schema"
    },

    "fill": [
    ]
  }
},

{
  "_name": "Repeat (negative array items, invalid)",

  "fixtures": {
    "forms": [{
      "meta": {
        "id": "form"
      },
      "fields": [{
        "id": "field",
        "type": "integer",
        "repeat": [ -2, -1 ]
      }]
    }],

    "input": [
    ]
  },

  "expect": {
    "load": {
      "valid": false,
      "phase": "schema"
    },

    "fill": [
    ]
  }
}

]
